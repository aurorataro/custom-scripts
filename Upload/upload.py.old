import sys
import requests
import os
import time


def push_nonebot(push_title, push_desp):
    data = {"token": "xxxxxxxx", "title": push_title, "content": push_desp,
            "send_to": "xxxxxxxxxx"#, "send_to_group": "xxxxxxxxxx"
            }
    requests.post('http://xxxxxxxxxxxxxx', json=data)
    return


def get_FileSize(file_path_first):
    size = os.path.getsize(file_path_first)
    size = size/float(1024*1024)
    return round(size, 2)


(spcrit, file_path) = sys.argv
(tmpfilepath, file_name_first) = os.path.split(file_path1)
get_FileSize(file_path1)
push_title = "ğŸ¥å½•åƒå¼€å§‹ä¸Šä¼ è‡³BILIBILI"
push_desp = file_name_first+' ç­‰...\nå…±' + \
    str(len(sys.argv)-1)+'P\n' + \
    str(time.strftime("%Y-%m-%d %H:%M:%S", time.localtime()))
push_nonebot(push_title, push_desp)
command = '/root/biliuprs/biliup upload --copyright 1 --cover "/root/biliuprs/livecover.jpg" --desc "@æµäº‘å¿ƒAurora çš„FF14å½•åƒ" --line qn --no-reprint 1 --tag "ç›´æ’­å½•åƒ","FF14" --tid 65 --title "ã€æµäº‘å¿ƒã€‘title xx-xx-xx [FFXIV]" '
upload = command + file_path
code = os.system(upload)
if code == 0:
    push_title = "âœ”ï¸æˆåŠŸä¸Šä¼ è‡³ğŸ“ºBILIBILIâœ”ï¸"
    push_desp = "è¯·ç­‰å¾…å®¡æ ¸ğŸ‘€å’Œæœºå™¨äººæ¨é€ğŸ¤–\n" + \
        str(time.strftime("%Y-%m-%d %H:%M:%S", time.localtime()))
else:
    push_title = "âŒä¸Šä¼ å‡ºç°é—®é¢˜âŒ"
    push_desp = "é”™è¯»ä»£ç ä¸º"+str(code)+"\nè¯·æ£€æŸ¥æ—¥å¿—ğŸ‘€\n" + \
        str(time.strftime("%Y-%m-%d %H:%M:%S", time.localtime()))
push_nonebot(push_title, push_desp)
